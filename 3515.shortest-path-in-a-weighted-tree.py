#\n# @lc app=leetcode id=3515 lang=python3\n#\n# [3515] Shortest Path in a Weighted Tree\n#\n\n# @lc code=start\nfrom typing import List\nimport sys\nsys.setrecursionlimit(10**6)\n\nclass FenwickTree:\n    def __init__(self, size: int):\n        self.size = size\n        self.tree = [0] * (size + 1)\n\n    def update(self, index: int, delta: int) -> None:\n        while index <= self.size:\n            self.tree[index] += delta\n            index += index & -index\n\n    def query(self, index: int) -> int:\n        res = 0\n        while index > 0:\n            res += self.tree[index]\n            index -= index & -index\n        return res\n\nclass Solution:\n    def treeQueries(self, n: int, edges: List[List[int]], queries: List[List[int]]) -> List[int]:\n        adj = [[] for _ in range(n + 1)]\n        for a, b, c in edges:\n            adj[a].append((b, c))\n            adj[b].append((a, c))\n        parent = [0] * (n + 1)\n        edge_weight = [0] * (n + 1)\n        in_time = [0] * (n + 1)\n        out_time = [0] * (n + 1)\n        timer = [0]\n        def dfs(node: int, par: int) -> None:\n            parent[node] = par\n            timer[0] += 1\n            in_time[node] = timer[0]\n            for nei, w in adj[node]:\n                if nei != par:\n                    edge_weight[nei] = w\n                    dfs(nei, node)\n            timer[0] += 1\n            out_time[node] = timer[0]\n        dfs(1, 0)\n        ft = FenwickTree(timer[0])\n        for i in range(2, n + 1):\n            ft.update(in_time[i], edge_weight[i])\n            ft.update(out_time[i], -edge_weight[i])\n        ans = []\n        for query in queries:\n            if query[0] == 2:\n                ans.append(ft.query(in_time[query[1]]))\n            else:\n                u, v, w = query[1], query[2], query[3]\n                child = u if parent[u] == v else v\n                delta = w - edge_weight[child]\n                edge_weight[child] = w\n                ft.update(in_time[child], delta)\n                ft.update(out_time[child], -delta)\n        return ans\n\n# @lc code=end