[Complete implementation code matching the template language and structure]