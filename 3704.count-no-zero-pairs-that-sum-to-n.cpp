Approach the problem systematically:

First, understand the requirements and identify critical constraints, especially maximum input sizes.

When considering solution approaches, immediately evaluate feasibility. Calculate the time complexity and verify it can handle the maximum constraint. For example, an O(n) solution where n can be 10^15 means 10^15 operations, which will timeout - reject such approaches immediately.

Implement your selected approach with complete, working code. Do not use TODO comments or placeholders. Every function must be fully implemented. If you discover during implementation that your approach won't work, stop, discard the incomplete code, and select a different approach.

Finally, test your solution with the provided examples to verify it produces correct outputs.